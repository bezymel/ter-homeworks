# Домашнее задание к занятию «Введение в Terraform»

### Цели задания

1. Установить и настроить Terrafrom.
2. Научиться использовать готовый код.

------

### Чек-лист готовности к домашнему заданию

1. Скачайте и установите **Terraform** версии =1.5.Х (версия 1.6 может вызывать проблемы с Яндекс провайдером) . Приложите скриншот вывода команды ```terraform --version```.
2. Скачайте на свой ПК этот git-репозиторий. Исходный код для выполнения задания расположен в директории **01/src**.
3. Убедитесь, что в вашей ОС установлен docker.
4. Зарегистрируйте аккаунт на сайте https://hub.docker.com/, выполните команду docker login и введите логин, пароль.

------

### Инструменты и дополнительные материалы, которые пригодятся для выполнения задания

1. Репозиторий с ссылкой на зеркало для установки и настройки Terraform: [ссылка](https://github.com/netology-code/devops-materials).
2. Установка docker: [ссылка](https://docs.docker.com/engine/install/ubuntu/). 
------
### Внимание!! Обязательно предоставляем на проверку получившийся код в виде ссылки на ваш github-репозиторий!
------

### Задание 1

1. Перейдите в каталог [**src**](https://github.com/netology-code/ter-homeworks/tree/main/01/src). Скачайте все необходимые зависимости, использованные в проекте. 
2. Изучите файл **.gitignore**. В каком terraform-файле, согласно этому .gitignore, допустимо сохранить личную, секретную информацию?
3. Выполните код проекта. Найдите  в state-файле секретное содержимое созданного ресурса **random_password**, пришлите в качестве ответа конкретный ключ и его значение.
4. Раскомментируйте блок кода, примерно расположенный на строчках 29–42 файла **main.tf**.
Выполните команду ```terraform validate```. Объясните, в чём заключаются намеренно допущенные ошибки. Исправьте их.
5. Выполните код. В качестве ответа приложите: исправленный фрагмент кода и вывод команды ```docker ps```.
6. Замените имя docker-контейнера в блоке кода на ```hello_world```. Не перепутайте имя контейнера и имя образа. Мы всё ещё продолжаем использовать name = "nginx:latest". Выполните команду ```terraform apply -auto-approve```.
Объясните своими словами, в чём может быть опасность применения ключа  ```-auto-approve```. Догадайтесь или нагуглите зачем может пригодиться данный ключ? В качестве ответа дополнительно приложите вывод команды ```docker ps```.
8. Уничтожьте созданные ресурсы с помощью **terraform**. Убедитесь, что все ресурсы удалены. Приложите содержимое файла **terraform.tfstate**. 
9. Объясните, почему при этом не был удалён docker-образ **nginx:latest**. Ответ **ОБЯЗАТЕЛЬНО НАЙДИТЕ В ПРЕДОСТАВЛЕННОМ КОДЕ**, а затем **ОБЯЗАТЕЛЬНО ПОДКРЕПИТЕ** строчкой из документации [**terraform провайдера docker**](https://docs.comcloud.xyz/providers/kreuzwerker/docker/latest/docs).  (ищите в классификаторе resource docker_image )

### Ответ 1

Согласно содержимому файла .gitignore, в Terraform-файле personal.auto.tfvars допустимо сохранить личную, секретную информацию. Этот файл не упоминается в правилах игнорирования .tfstate или .terraform, поэтому Terraform не будет игнорировать его содержимое при выполнении операций.

![image](https://github.com/bezymel/ter-homeworks/assets/129361495/2f0adbfb-6923-44aa-a667-b994972728dd)
![image](https://github.com/bezymel/ter-homeworks/assets/129361495/00ba51ed-e5d4-4574-aaf7-2abe4e0fc9d2)
![image](https://github.com/bezymel/ter-homeworks/assets/129361495/1e1d7e5e-ddd5-4115-afef-77eba4ed4177)
![image](https://github.com/bezymel/ter-homeworks/assets/129361495/9f77bf6a-50dc-45e0-adb6-85a697af8ad5)
![image](https://github.com/bezymel/ter-homeworks/assets/129361495/d7a17a7b-79f1-4319-a2a0-21db21f089dd)
![image](https://github.com/bezymel/ter-homeworks/assets/129361495/b78fe7ea-39ed-4bde-be2e-dd72072b8c93)

Ошибки, с которыми я столкнулся, связаны с отсутствием имен ресурсов в конфигурации Terraform. Каждый блок ресурсов в Terraform должен иметь тип и имя.

![image](https://github.com/bezymel/ter-homeworks/assets/129361495/066d0d0f-9bae-479c-80bc-afabf84427a8)
![image](https://github.com/bezymel/ter-homeworks/assets/129361495/3f5871a8-8237-4772-9ee7-53c0b28ab3b7)
![image](https://github.com/bezymel/ter-homeworks/assets/129361495/3eaf9db9-7790-4215-8687-fe0d6df26142)
![image](https://github.com/bezymel/ter-homeworks/assets/129361495/6cbd409c-2717-486f-b436-51a11498b03c)
![image](https://github.com/bezymel/ter-homeworks/assets/129361495/54426bc5-4371-4b28-9ce5-4e5792da10ef)

Ключ -auto-approve в Terraform предназначен для автоматического подтверждения применения изменений без запроса подтверждения у пользователя. Это может быть опасно из-за следующих причин:

1. Потеря контроля: При использовании ключа -auto-approve вы не будете видеть предварительный анализ плана действий Terraform, что может привести к непредвиденным изменениям в вашей инфраструктуре.
2. Потенциальные ошибки: Если в вашем конфигурационном файле Terraform есть ошибки или непредвиденные изменения, ключ -auto-approve может привести к применению этих ошибок без возможности их предварительного исправления.
3. Безопасность: Подтверждение действий перед их выполнением обеспечивает уровень безопасности, поскольку вы имеете возможность внимательно просмотреть, что именно будет изменено в вашей инфраструктуре.

Ключ -auto-approve может быть полезен в ситуациях, когда вам необходимо автоматизировать процесс применения изменений в инфраструктуре, но его использование должно быть осмотрительным, особенно в контексте безопасности и контроля над изменениями.

![image](https://github.com/bezymel/ter-homeworks/assets/129361495/20e71764-2486-411a-ba26-bea7276e4953)
![image](https://github.com/bezymel/ter-homeworks/assets/129361495/0d3039c1-b004-4408-90ae-f6ec9eacac05)

В предоставленном коде Terraform не указано удаление docker-образа nginx:latest из-за того, что в конфигурации приведены только действия по загрузке образа ubuntu:latest и созданию контейнера на его основе.
Согласно документации провайдера Docker для Terraform (https://docs.comcloud.xyz/providers/kreuzwerker/docker/latest/docs), для удаления docker-образа следует использовать аргумент absent. Этот параметр позволяет управлять состоянием образа: созданием, обновлением или удалением. Вот как это выглядит в общем виде:

```
resource "docker_image" "example" {
  name   = "nginx:latest"
  ensure = "absent"
}
```

В данном примере, параметр ensure установлен в значение "absent", указывающее Terraform на необходимость удалить образ с именем "nginx:latest".

------

### Правила приёма работы

Домашняя работа оформляется в отдельном GitHub-репозитории в файле README.md.   
Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

### Критерии оценки

Зачёт ставится, если:

* выполнены все задания,
* ответы даны в развёрнутой форме,
* приложены соответствующие скриншоты и файлы проекта,
* в выполненных заданиях нет противоречий и нарушения логики.

На доработку работу отправят, если:

* задание выполнено частично или не выполнено вообще,
* в логике выполнения заданий есть противоречия и существенные недостатки. 

